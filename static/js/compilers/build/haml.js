var Haml;
(function(){function e(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")}function l(a){var b,d,c=[];for(b in a)if(b!=="_content"&&a.hasOwnProperty(b))switch(a[b]){case "undefined":case "false":case "null":case '""':break;default:try{d=JSON.parse("["+a[b]+"]")[0],d=d===!0?b:typeof d==="string"&&j.test(d)?'" +\n'+h(e(d))+' +\n"':e(d),c.push(" "+b+'=\\"'+d+'\\"')}catch(i){c.push(" "+b+'=\\"" + '+f+"("+a[b]+') + "\\"')}}return c.join("")}function w(a){var b,
d,c;function i(){if(typeof b==="number"&&typeof d==="number"&&typeof c==="number"){var i=a.substr(b,d-b).trim(),e=a.substr(d+1,c-d-1).trim();n[i]=e}b=null;d=null;c=null}var n={},o=a.length,e,g,f=1,h=!1,p=!1,m,j,k,l;b=1;d=null;c=null;if(!(o>0&&(a.charAt(0)==="{"||a.charAt(0)==="(")))return{_content:a[0]===" "?a.substr(1,o):a};m=a.charAt(0);j=m==="{"?"}":")";k=m==="{"?":":"=";l=m==="{"?",":" ";for(e=1;f>0;e+=1){if(e>o)throw"Malformed attribute block";g=a.charAt(e);if(p)p=!1;else if(h)g==="\\"&&(p=!0),
g===h&&(h=!1);else{if(g==='"'||g==="'")h=g;if(f===1&&(g===k&&(d=e),g===l||g===j))c=e,i(),g===l&&(b=e+1);if(g===m||g==="(")f+=1;if(g===j||f>1&&g===")")f-=1}}n._content=a.substr(e,a.length);return n}function h(a){for(var b=[],d=0,c=0,i;;){c=a.substr(d).search(j);if(c<0){d<a.length&&b.push(JSON.stringify(a.substr(d)));break}b.push(JSON.stringify(a.substr(d,c)));d+=c;i=a.substr(d).match(j);c=i[0].length;if(c<0)break;i[1]==="#"?b.push(f+"("+(i[2]||i[3])+")"):b.push(i[2]||i[3]);d+=c}return b.filter(function(c){return c&&
c.length>0}).join(" +\n")}function k(a){var b=!1,d=[];typeof a==="string"&&(a=a.trim().replace(/\n\r|\r/g,"\n").split("\n"));a.forEach(function(c){var a,e=!1;if(b)if(a=b.check_indent.exec(c)){b.contents.push(a[1]||"");return}else d.push(b.process()),b=!1;q.forEach(function(d){if(!e&&(a=d.regexp.exec(c)))b={contents:[],indent_level:a[1],matches:a,check_indent:RegExp("^(?:\\s*|"+a[1]+"  (.*))$"),process:d.process,render_contents:function(){return k(this.contents)}},e=!0});e||d.push(function(){function a(){try{return f+
"("+JSON.stringify(JSON.parse(c))+")"}catch(b){return f+"("+c+")"}}function b(){try{return h(JSON.parse(c))}catch(a){return c}}if(c[0]==="\\")return h(c.substr(1,c.length));if(c.substr(0,2)==="&=")return c=c.substr(2,c.length).trim(),a();if(c.substr(0,2)==="!=")return c=c.substr(2,c.length).trim(),b();return c[0]==="="?(c=c.substr(1,c.length).trim(),r?a():b()):h(c)}())});b&&d.push(b.process());a=d.filter(function(a){return a&&a.length>0}).join(" +\n");a.length==0&&(a='""');return a}function s(a){function b(){c.length>
0&&(d.push(JSON.stringify(c.join(""))+f),c=[])}var d=[],c=[],e,f;a.replace(/\n\r|\r/g,"\n").split("\n").forEach(function(a){if(e=a.match(/^(\".*\")(\s*\+\s*)?$/)){f=e[2]||"";e=e[1];try{c.push(JSON.parse(e))}catch(h){b(),d.push(a)}}else b(),d.push(a)});b();return d.join("\n")}function t(a,b,d){return function(){with(d||{})try{eval("_$output ="+a)}catch(b){return"\n<pre class='error'>"+e(b.stack)+"</pre>\n"}}.call(b)}var q,u,j,v,f,r;j=/([#!])\{([^}]*)\}/;u="meta,img,link,br,hr,input,area,base".split(",");
q=[{name:"html tags",regexp:/^(\s*)((?:[.#%][a-z_\-][a-z0-9_:\-]*)+)(.*)$/i,process:function(){var i;var a,b,d,c,e,f;a=this.matches[2];b=a.match(/\.([a-z_\-][a-z0-9_\-]*)/gi);d=a.match(/\#([a-z_\-][a-z0-9_\-]*)/gi);i=(a=a.match(/\%([a-z_\-][a-z0-9_:\-]*)/gi))?a[0].substr(1,a[0].length):"div",a=i;if(c=this.matches[3]){if(c=w(c),c._content){var h=c._content.charAt(0),j=c._content.charAt(1),g=0;h=="<"?(g++,e=!0,j==">"&&(g++,f=!0)):h==">"&&(g++,f=!0,j=="<"&&(g++,e=!0));c._content=c._content.substr(g);
this.contents.unshift(c._content.trim());delete c._content}}else c={};if(b)if(b=b.map(function(a){return a.substr(1,a.length)}).join(" "),c["class"])try{c["class"]=JSON.stringify(b+" "+JSON.parse(c["class"]))}catch(k){c["class"]=JSON.stringify(b+" ")+" + "+c["class"]}else c["class"]=JSON.stringify(b);if(d)d=d.map(function(a){return a.substr(1,a.length)}).join(" "),c.id=c.id?JSON.stringify(d+" ")+c.id:JSON.stringify(d);c=l(c);b=this.render_contents();b==='""'&&(b="");if(e)if(b.length==0)b='"  "';else try{b=
'" '+JSON.parse(b)+' "'}catch(q){b='" "+\n'+b+'+\n" "'}e=(v?b.length>0:u.indexOf(a)==-1)?'"<'+a+c+'>"'+(b.length>0?" + \n"+b:"")+' + \n"</'+a+'>"':'"<'+a+c+' />"';f&&(e='" '+e.substr(1,e.length-2)+' "');return e}},{name:"each loop",regexp:/^(\s*)(?::for|:each)\s+(?:([a-z_][a-z_\-]*),\s*)?([a-z_][a-z_\-]*)\s+in\s+(.*)(\s*)$/i,process:function(){var a=this.matches[2]||"__key__",b=this.matches[3],d=this.matches[4];this.matches[5]&&this.contents.unshift(this.matches[5]);return"(function () { var __result__ = [], "+
a+", "+b+"; for ("+a+" in "+d+") { if ("+d+".hasOwnProperty("+a+")) { "+b+" = "+d+"["+a+"]; __result__.push(\n"+(this.render_contents()||"''")+'\n); } } return __result__.join(""); }).call(this)'}},{name:"if",regexp:/^(\s*):if\s+(.*)\s*$/i,process:function(){return"(function () { if ("+this.matches[2]+") { return (\n"+(this.render_contents()||"")+'\n);} else { return ""; } }).call(this)'}},{name:"silent-comments",regexp:/^(\s*)-#\s*(.*)\s*$/i,process:function(){return'""'}},{name:"silent-comments",
regexp:/^(\s*)\/\s*(.*)\s*$/i,process:function(){this.contents.unshift(this.matches[2]);return'"<\!--'+this.contents.join("\\n")+'--\>"'}},{name:"rawjs",regexp:/^(\s*)-\s*(.*)\s*$/i,process:function(){this.contents.unshift(this.matches[2]);return'"";'+this.contents.join("\n")+"; _$output = _$output "}},{name:"pre",regexp:/^(\s*):pre(\s+(.*)|$)/i,process:function(){this.contents.unshift(this.matches[2]);return'"<pre>"+\n'+JSON.stringify(this.contents.join("\n"))+'+\n"</pre>"'}},{name:"doctype",regexp:/^()!!!(?:\s*(.*))\s*$/,
process:function(){var a="";switch((this.matches[2]||"").toLowerCase()){case "":a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';break;case "strict":case "1.0":a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';break;case "frameset":a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';break;case "5":a=
"<!DOCTYPE html>";break;case "1.1":a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';break;case "basic":a='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">';break;case "mobile":a='<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.2//EN" "http://www.openmobilealliance.org/tech/DTD/xhtml-mobile12.dtd">';break;case "xml":a="<?xml version='1.0' encoding='utf-8' ?>";break;case "xml iso-8859-1":a=
"<?xml version='1.0' encoding='iso-8859-1' ?>"}return JSON.stringify(a+"\n")}},{name:"markdown",regexp:/^(\s*):markdown\s*$/i,process:function(){return h(exports.Markdown.encode(this.contents.join("\n")))}},{name:"script",regexp:/^(\s*):(?:java)?script\s*$/,process:function(){return h('\n<script type="text/javascript">\n//<![CDATA[\n'+this.contents.join("\n")+"\n//]]\>\n<\/script>\n")}},{name:"css",regexp:/^(\s*):css\s*$/,process:function(){return JSON.stringify('<style type="text/css">\n'+this.contents.join("\n")+
"\n</style>")}}];Haml=function(a,b){typeof b!="object"&&(v=b,b={});var d;b.customEscape?(d="",f=b.customEscape):(d=e.toString()+"\n",f="html_escape");r=b.escapeHtmlByDefault||b.escapeHTML||b.escape_html;var c="with(locals || {}) {\n  try {\n   var _$output="+s(k(a))+";\n return _$output;  } catch (e) {\n    return \"\\n<pre class='error'>\" + "+f+'(e.stack) + "</pre>\\n";\n  }\n}';try{return new Function("locals",d+c)}catch(h){throw typeof console!=="undefined"&&console.error(c),h;}};Haml.compile=
k;Haml.optimize=s;Haml.render=function(a,b){var b=b||{},d=k(a||"",b);b.optimize&&(d=Haml.optimize(d));return t(d,b.context||Haml,b.locals)};Haml.execute=t;Haml.html_escape=e})();if(typeof module!=="undefined")module.exports=Haml;function sendResult(e){typeof e==="undefined"||e===null||!e.length||postMessage({type:"result",resultText:e})}function sendError(e){postMessage({type:"error",errorText:e})}
self.addEventListener("message",function(e){try{html=Haml(e.data.code.replace("\t","    "))(e.data.locals),sendResult(html)}catch(l){sendError(l.message)}},!1);
