(function(){function e(a){for(var b={},a=a.split(","),c=0;c<a.length;c++)b[a[c]]=!0;return b}var i=/^<([-A-Za-z0-9_]+)((?:\s+[\w-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,l=/^<\/([-A-Za-z0-9_]+)[^>]*>/,n=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,o=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),p=e("article,aside,canvas,figcaption,figure,footer,header,hgroup,output,progress,section,video,address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),
q=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),r=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),s=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),t=e("script,style"),m=this.HTMLParser=function(a,b){function c(a,c,d,h){if(p[c])for(;f.last()&&q[f.last()];)e("",f.last());r[c]&&f.last()==
c&&e("",c);(h=o[c]||!!h)||f.push(c);if(b.start){var g=[];d.replace(n,function(b,a,c,d,f){b=c?c:d?d:f?f:s[a]?a:"";g.push({name:a,value:b,escaped:b.replace(/(^|[^\\])"/g,'$1\\"')})});b.start&&b.start(c,g,h)}}function e(a,c){if(c)for(d=f.length-1;d>=0;d--){if(f[d]==c)break}else var d=0;if(d>=0){for(var h=f.length-1;h>=d;h--)b.end&&b.end(f[h]);f.length=d}}var d,g,f=[],h=a;for(f.last=function(){return this[this.length-1]};a;){g=!0;if(!f.last()||!t[f.last()]){if(a.indexOf("<\!--")==0)d=a.indexOf("--\>"),
d>=0&&(b.comment&&b.comment(a.substring(4,d)),a=a.substring(d+3),g=!1);else if(a.indexOf("</")==0){if(d=a.match(l))a=a.substring(d[0].length),d[0].replace(l,e),g=!1}else if(a.indexOf("<")==0&&(d=a.match(i)))a=a.substring(d[0].length),d[0].replace(i,c),g=!1;g&&(d=a.indexOf("<"),g=d<0?a:a.substring(0,d),a=d<0?"":a.substring(d),b.chars&&b.chars(g))}else a=a.replace(RegExp("(.*)</"+f.last()+"[^>]*>"),function(a,c){c=c.replace(/<\!--(.*?)--\>/g,"$1").replace(/<!\[CDATA\[(.*?)]]\>/g,"$1");b.chars&&b.chars(c);
return""}),e("",f.last());if(a==h)throw"Parse Error: "+a;h=a}e()};this.HTMLtoXML=function(a){var b="";m(a,{start:function(c,a,d){b+="<"+c;for(c=0;c<a.length;c++)b+=" "+a[c].name+'="'+a[c].escaped+'"';b+=(d?"/":"")+">"},end:function(a){b+="</"+a+">"},chars:function(a){b+=a},comment:function(a){b+="<\!--"+a+"--\>"}});return b};this.HTMLtoDOM=function(a,b){var c=e("html,head,body,title"),i={link:"head",base:"head"};b?b=b.ownerDocument||b.getOwnerDocument&&b.getOwnerDocument()||b:typeof DOMDocument!=
"undefined"?b=new DOMDocument:typeof document!="undefined"&&document.implementation&&document.implementation.createDocument?b=document.implementation.createDocument("","",null):typeof ActiveX!="undefined"&&(b=new ActiveXObject("Msxml.DOMDocument"));var d=[];!(b.documentElement||b.getDocumentElement&&b.getDocumentElement())&&b.createElement&&function(){var a=b.createElement("html"),c=b.createElement("head");c.appendChild(b.createElement("title"));a.appendChild(c);a.appendChild(b.createElement("body"));
b.appendChild(a)}();if(b.getElementsByTagName)for(var g in c)c[g]=b.getElementsByTagName(g)[0];var f=c.body;m(a,{start:function(a,e,g){if(c[a])f=c[a];else{var j=b.createElement(a),k;for(k in e)j.setAttribute(e[k].name,e[k].value);i[a]&&typeof c[i[a]]!="boolean"?c[i[a]].appendChild(j):f&&f.appendChild&&f.appendChild(j);g||(d.push(j),f=j)}},end:function(){d.length-=1;f=d[d.length-1]},chars:function(a){f.appendChild(b.createTextNode(a))},comment:function(){}});return b}})();
function sendResult(e){typeof e==="undefined"||e===null||!e.length||postMessage({type:"result",resultText:e})}function sendError(e){postMessage({type:"error",errorText:e})}self.addEventListener("message",function(e){try{sendResult(HTMLtoXML(e.data))}catch(i){}},!1);
